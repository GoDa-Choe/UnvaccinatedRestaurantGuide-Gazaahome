{% extends 'forum/base_full_width.html' %}
{% load static %}

{% block head-title %}
    {{ calculator.name }}
{% endblock %}

{% block custom_style %}
    <style>
        .bt-ft {
            font-size: 12px;
        }
    </style>
{% endblock %}

{% block main-area %}


    <hr/>
    <h2 class="my-3">{{ calculator.name }}</h2>
    <h3>복무 시작일 : {{ calculator.start_date }}</h3>
    <h3>전역일 : {{ calculator.end_date }}</h3>
    <hr/>

    <hr/>
    <h2 class="my-3">{{ today }}</h2>
    <h3>전역까지 : {{ service_days|length }}</h3>
    <h3>복무 일수 : {{ serviced_days|length }}</h3>
    <h3>퍼센트 : {{ percent }}%</h3>
    <h3>남은 실출근 : {{ workdays|length }}</h3>
    <hr/>

    <a href="{% url 'workday:update' calculator.pk %}"> 달력 수정</a>

    <hr/>

    {% if user == calculator.author %}
        <a class="btn btn-info btn-sm float-end" href="{% url 'workday:create_leave' calculator.pk %}"
           role="button">
            <i class="fas fa-pen"> 휴가 등록</i>
        </a>
    {% endif %}
    <h2>휴가 목록</h2>
    {% for leave in calculator.leave_set.all %}
        {% if user == calculator.author %}
            <a class="btn btn-info btn-sm float-end"
               href="{% url 'workday:delete_leave' calculator.pk leave.pk %}"
               role="button">
                <i class="fas fa-pen"> 휴가 삭제</i>
            </a>
        {% endif %}

        <p>{{ forloop.counter }}. 시작일:{{ leave.start_date|date:'Y-m-d' }} | 종료일:{{ leave.start_date|date:'Y-m-d' }}
            | 기간:{{ leave.days.days }}</p>
    {% endfor %}
    <hr/>

    <h2>휴일 목록</h2>
    {% for dayoff in dayoffs %}
        <span>{{ dayoff|date:'Y-m-d' }}</span>
    {% endfor %}
    <hr/>


    <div class="row justify-content-center">
        {% for month_block in blocked_service_days %}
            <div class="col-auto">
                <div class="card text-center my-3" style="min-width: 350px; max-width: 380px">
                    <div class="card-header">
                        <h5>{{ month_block.8.year }}-{{ month_block.8.month }}</h5>
                    </div>

                    <div class="card-body px-0">
                        {% for weekday in weekdays %}
                            <button type="button" class="btn text-dark cal-bt" style="width: 44px">
                                <span class="bt-ft">{{ weekday }}</span>
                            </button>
                        {% endfor %}

                        {% for date in month_block %}
                            {% if date == None %}
                                <button type="button" class="btn text-white" disabled style="width: 44px">
                                    <span class="bt-ft">00</span>
                                </button>
                            {% elif date == calculator.start_date or date == calculator.end_date %}
                                <button type="button" class="btn btn-warning" style="width: 44px">
                                    <span class="bt-ft">{{ date|date:'d' }}</span>
                                </button>
                            {% elif date in leaves %}
                                <button type="button" class="btn btn-primary" style="width: 44px">
                                    <span class="bt-ft">{{ date|date:'d' }}</span>
                                </button>
                            {% elif date in serviced_days or date in dayoffs %}
                                <button type="button" class="btn btn-secondary" style="width: 44px">
                                    <span class="bt-ft">{{ date|date:'d' }}</span>
                                </button>
                            {% else %}
                                <button type="button" class="btn btn-outline-secondary" style="width: 44px">
                                    <span class="bt-ft">{{ date|date:'d' }}</span>
                                </button>
                            {% endif %}
                        {% endfor %}

                    </div>
                </div>
            </div>
        {% endfor %}
    </div>



{% endblock %}
